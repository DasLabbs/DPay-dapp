import { Link, useLocation } from 'react-router-dom';

const HomeIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width={22} height={22} viewBox="0 0 22 22" fill="none">
    <path
      d="M8.07874 15.1354H13.8937"
      stroke="currentColor"
      strokeWidth={1.5}
      strokeLinecap="round"
      strokeLinejoin="round"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M1.40002 12.713C1.40002 7.082 2.01402 7.475 5.31902 4.41C6.76502 3.246 9.01502 1 10.958 1C12.9 1 15.195 3.235 16.654 4.41C19.959 7.475 20.572 7.082 20.572 12.713C20.572 21 18.613 21 10.986 21C3.35903 21 1.40002 21 1.40002 12.713Z"
      stroke="currentColor"
      strokeWidth={1.5}
      strokeLinecap="round"
      strokeLinejoin="round"
    />
  </svg>
);

const HistoryIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width={24} height={24} viewBox="0 0 24 24" fill="none">
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M21.25 12C21.25 17.109 17.109 21.25 12 21.25C6.891 21.25 2.75 17.109 2.75 12C2.75 6.891 6.891 2.75 12 2.75C17.109 2.75 21.25 6.891 21.25 12Z"
      stroke="currentColor"
      strokeWidth={1.5}
      strokeLinecap="square"
    />
    <path d="M15.4321 14.9422L11.6621 12.6932V7.84619" stroke="currentColor" strokeWidth={1.5} strokeLinecap="square" />
  </svg>
);

const ScanIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width={24} height={24} viewBox="0 0 24 24" fill="none">
    <path
      d="M11.12 6.96002V9.55502C11.1268 9.87108 11.038 10.1818 10.8653 10.4466C10.6926 10.7114 10.444 10.9179 10.152 11.039C9.95803 11.1198 9.75007 11.1616 9.53998 11.162H6.93998C6.52053 11.162 6.11806 10.9963 5.82025 10.7009C5.52244 10.4056 5.35341 10.0045 5.34998 9.58502V6.99002C5.34971 6.78129 5.39068 6.57456 5.47053 6.3817C5.55038 6.18884 5.66753 6.01365 5.81527 5.86619C5.96301 5.71873 6.13842 5.60191 6.33143 5.52243C6.52443 5.44294 6.73124 5.40236 6.93998 5.40302H9.53998C9.95428 5.40554 10.3512 5.56967 10.6463 5.86048C10.9414 6.15129 11.1114 6.5458 11.12 6.96002ZM11.12 14.455V17.05C11.1205 17.4699 10.9544 17.8728 10.6582 18.1703C10.362 18.4678 9.95983 18.6357 9.53998 18.637H6.93998C6.5188 18.637 6.11483 18.4699 5.81674 18.1724C5.51864 17.8749 5.35077 17.4712 5.34998 17.05V14.455C5.35209 14.0352 5.52071 13.6333 5.8188 13.3377C6.1169 13.042 6.52013 12.8767 6.93998 12.878H9.53998C9.9585 12.878 10.3599 13.0441 10.6561 13.3397C10.9524 13.6354 11.1192 14.0365 11.12 14.455ZM18.66 6.96002V9.55502C18.6659 9.9715 18.5077 10.3736 18.2195 10.6743C17.9313 10.975 17.5363 11.1502 17.12 11.162H14.53C14.1105 11.162 13.7081 10.9963 13.4102 10.7009C13.1124 10.4056 12.9434 10.0045 12.94 9.58502V6.99002C12.9397 6.78129 12.9807 6.57456 13.0605 6.3817C13.1404 6.18884 13.2575 6.01365 13.4053 5.86619C13.553 5.71873 13.7284 5.60191 13.9214 5.52243C14.1144 5.44294 14.3212 5.40236 14.53 5.40302H17.12C17.5273 5.41575 17.9142 5.5844 18.2008 5.87414C18.4873 6.16387 18.6517 6.55259 18.66 6.96002ZM18.66 14.475V17.07C18.6607 17.4831 18.5001 17.88 18.2125 18.1765C17.9248 18.4729 17.5328 18.6453 17.12 18.657H14.53C14.1088 18.657 13.7048 18.4899 13.4067 18.1924C13.1086 17.8949 12.9408 17.4912 12.94 17.07V14.475C12.9424 14.0553 13.1111 13.6536 13.4091 13.358C13.7071 13.0623 14.1102 12.897 14.53 12.898H17.12C17.5307 12.9109 17.9205 13.0824 18.2076 13.3764C18.4947 13.6704 18.6568 14.0641 18.66 14.475Z"
      fill="currentColor"
    />
    <path
      d="M21.25 9.695C21.052 9.69242 20.8629 9.6127 20.7229 9.47282C20.5828 9.33294 20.5028 9.14393 20.5 8.946V5.862C20.5071 5.54951 20.4505 5.23884 20.3336 4.94896C20.2167 4.65908 20.0419 4.39608 19.82 4.176C19.3806 3.74155 18.7879 3.49762 18.17 3.497H15.12C14.9214 3.497 14.7309 3.41826 14.5904 3.27804C14.4498 3.13782 14.3705 2.94757 14.37 2.749C14.3702 2.55026 14.4494 2.35975 14.59 2.21932C14.7306 2.07888 14.9212 2 15.12 2H18.2C19.2133 2.02554 20.176 2.44867 20.88 3.178C21.2361 3.5323 21.5185 3.95371 21.7107 4.41785C21.903 4.88198 22.0013 5.37963 22 5.882V8.966C21.9945 9.16125 21.9131 9.34666 21.773 9.48281C21.633 9.61895 21.4453 9.69508 21.25 9.695ZM18.17 22H15.12C14.9214 22 14.7309 21.9213 14.5904 21.781C14.4498 21.6408 14.3705 21.4506 14.37 21.252C14.3702 21.0533 14.4494 20.8628 14.59 20.7223C14.7306 20.5819 14.9212 20.503 15.12 20.503H18.2C18.6612 20.4993 19.1108 20.3583 19.4914 20.0979C19.872 19.8374 20.1664 19.4695 20.337 19.041C20.4501 18.7571 20.5055 18.4535 20.5 18.148V15.094C20.5002 14.8953 20.5794 14.7048 20.72 14.5643C20.8606 14.4239 21.0512 14.345 21.25 14.345C21.4487 14.345 21.6393 14.4239 21.78 14.5643C21.9206 14.7048 21.9997 14.8953 22 15.094V18.148C22.0019 18.9052 21.7781 19.6458 21.3572 20.2752C20.9363 20.9047 20.3374 21.3944 19.637 21.682C19.172 21.873 18.673 21.972 18.17 21.97V22ZM8.91997 22H5.83997C5.33428 21.9996 4.83361 21.8997 4.36657 21.7058C3.89952 21.5119 3.47524 21.2279 3.11797 20.87C2.76148 20.5125 2.47919 20.0881 2.28732 19.6211C2.09545 19.1541 1.9978 18.6538 1.99997 18.149V15.095C2.00024 14.8963 2.07937 14.7058 2.22 14.5653C2.36062 14.4249 2.55124 14.346 2.74997 14.346C2.94871 14.346 3.13933 14.4249 3.27995 14.5653C3.42058 14.7058 3.49971 14.8963 3.49997 15.095V18.149C3.50236 18.7675 3.75014 19.3598 4.18889 19.7957C4.62763 20.2316 5.22148 20.4756 5.83997 20.474H8.91997C9.11871 20.474 9.30933 20.5529 9.44995 20.6933C9.59058 20.8338 9.66971 21.0243 9.66997 21.223C9.67011 21.3214 9.65078 21.4189 9.61311 21.5099C9.57545 21.6008 9.52017 21.6834 9.45048 21.7529C9.38078 21.8224 9.29803 21.8775 9.20699 21.9149C9.11595 21.9523 9.01841 21.9714 8.91997 21.971V22ZM2.74997 9.695C2.55204 9.69242 2.36292 9.6127 2.22285 9.47282C2.08279 9.33294 2.00282 9.14393 1.99997 8.946V5.862C2.00263 4.85421 2.4055 3.88875 3.11997 3.178C3.84114 2.46346 4.81477 2.06179 5.82997 2.06H8.90997C9.10871 2.06 9.29933 2.13888 9.43995 2.27932C9.58057 2.41975 9.65971 2.61026 9.65997 2.809C9.65945 3.00757 9.58019 3.19782 9.4396 3.33804C9.299 3.47826 9.10854 3.557 8.90997 3.557H5.82997C5.2114 3.55514 4.6174 3.79902 4.17859 4.23501C3.73979 4.67101 3.49209 5.26342 3.48997 5.882V8.966C3.48457 9.15953 3.40453 9.34348 3.26661 9.47935C3.12869 9.61522 2.94357 9.69249 2.74997 9.695Z"
      fill="currentColor"
    />
  </svg>
);

const GiftIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width={20} height={21} viewBox="0 0 20 21" fill="none">
    <path
      d="M2 10V18C2 18.5304 2.21071 19.0391 2.58579 19.4142C2.96086 19.7893 3.46957 20 4 20H16C16.5304 20 17.0391 19.7893 17.4142 19.4142C17.7893 19.0391 18 18.5304 18 18V10"
      stroke="currentColor"
      strokeWidth={1.5}
      strokeLinecap="round"
      strokeLinejoin="round"
    />
    <path
      d="M10 4.5C10 3.57174 9.63125 2.6815 8.97487 2.02513C8.3185 1.36875 7.42826 1 6.5 1C5.83696 1 5.20107 1.26339 4.73223 1.73223C4.26339 2.20107 4 2.83696 4 3.5C4 4.16304 4.26339 4.79893 4.73223 5.26777C5.20107 5.73661 5.83696 6 6.5 6H10M10 4.5V6M10 4.5C10 3.57174 10.3687 2.6815 11.0251 2.02513C11.6815 1.36875 12.5717 1 13.5 1C14.163 1 14.7989 1.26339 15.2678 1.73223C15.7366 2.20107 16 2.83696 16 3.5C16 3.8283 15.9353 4.15339 15.8097 4.45671C15.6841 4.76002 15.4999 5.03562 15.2678 5.26777C15.0356 5.49991 14.76 5.68406 14.4567 5.8097C14.1534 5.93534 13.8283 6 13.5 6H10"
      stroke="currentColor"
      strokeWidth={1.5}
      strokeLinejoin="round"
    />
    <path
      d="M10 10V20M1 6H19V10H1V6Z"
      stroke="currentColor"
      strokeWidth={1.5}
      strokeLinecap="round"
      strokeLinejoin="round"
    />
  </svg>
);

const ProfileIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width={16} height={20} viewBox="0 0 16 20" fill="none">
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M7.8889 10.6188H7.92089C10.8489 10.6188 13.2299 8.23776 13.2299 5.30976C13.2299 2.38176 10.8489 -0.000244141 7.92089 -0.000244141C4.99189 -0.000244141 2.60989 2.38176 2.60989 5.30676C2.59989 8.22676 4.9669 10.6098 7.8889 10.6188ZM4.03789 5.30976C4.03789 3.16876 5.77989 1.42776 7.92089 1.42776C10.0609 1.42776 11.8019 3.16876 11.8019 5.30976C11.8019 7.44976 10.0609 9.19176 7.92089 9.19176H7.89189C5.75989 9.18376 4.03089 7.44376 4.03789 5.30976Z"
      fill="currentColor"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M-0.00012207 16.1731C-0.00012207 19.8701 5.96188 19.8701 7.92088 19.8701C11.3199 19.8701 15.8399 19.4891 15.8399 16.1931C15.8399 12.4961 9.87988 12.4961 7.92088 12.4961C4.52088 12.4961 -0.00012207 12.8771 -0.00012207 16.1731ZM1.49988 16.1731C1.49988 14.7281 3.65988 13.9961 7.92088 13.9961C12.1809 13.9961 14.3399 14.7351 14.3399 16.1931C14.3399 17.6381 12.1809 18.3701 7.92088 18.3701C3.65988 18.3701 1.49988 17.6311 1.49988 16.1731Z"
      fill="currentColor"
    />
  </svg>
);

const NAV_ITEMS = [
  {
    href: '/',
    label: 'Home',
    icon: HomeIcon,
    matchPaths: ['/'],
  },
  {
    href: '/history',
    label: 'History',
    icon: HistoryIcon,
    matchPaths: ['/history'],
    disabled: false,
  },
  {
    href: '/scan',
    label: 'Scan',
    icon: ScanIcon,
    matchPaths: ['/scan'],
    isSpecial: true, // Special circular background
  },
  {
    href: '/rewards',
    label: 'Reward',
    icon: GiftIcon,
    matchPaths: ['/rewards'],
  },
  {
    href: '/profile',
    label: 'Profile',
    icon: ProfileIcon,
    matchPaths: ['/profile'],
  },
];

const BottomBar = () => {
  const location = useLocation();
  const pathname = location.pathname;

  const isActive = (matchPaths: any[]) => {
    return matchPaths.some((path) => {
      if (path === '/') {
        return pathname === '/';
      }
      return pathname.startsWith(path);
    });
  };

  return (
    <div className="absolute bottom-0 left-0 right-0 z-10">
      <div className="bottom-bar-bg relative flex h-[96px] w-full items-center justify-center">
        <nav className="relative z-10 flex h-full w-full items-end justify-center gap-3 pb-[24px]">
          {NAV_ITEMS.map((item) => {
            const active = isActive(item.matchPaths);
            const IconComponent = item.icon;

            return (
              <Link
                key={item.href}
                to={item.href}
                className={`
                  flex w-[62px] flex-col items-center gap-2 whitespace-nowrap text-[10px] font-medium leading-[12px] transition-colors duration-200
                  ${active ? 'text-[#1712FF]' : 'text-[#7A7B83]'}
                  ${item.disabled ? 'cursor-not-allowed opacity-50' : 'hover:text-[#1712FF]'}
                `}
                onClick={item.disabled ? (e) => e.preventDefault() : undefined}
                aria-disabled={item.disabled}
              >
                {item.isSpecial ? (
                  <div
                    className={`
                    flex h-[40px] w-[40px] items-center justify-center rounded-full transition-colors duration-200
                    ${active ? 'bg-[#1712FF] text-white' : ' bg-[#1712FF] text-white'}
                  `}
                  >
                    <IconComponent />
                  </div>
                ) : (
                  <IconComponent />
                )}
                {item.label}
              </Link>
            );
          })}
        </nav>
      </div>
    </div>
  );
};

export default BottomBar;
